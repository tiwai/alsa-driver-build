--- ../alsa-kernel/firewire/speakers.c	2013-07-15 12:14:30.252860918 +0200
+++ speakers.c	2013-07-15 17:01:02.479566291 +0200
@@ -1,3 +1,7 @@
+#include "adriver.h"
+#if LINUX_VERSION_CODE <= KERNEL_VERSION(2, 6, 39)
+#include "iso-resources-old.h"
+#endif
 /*
  * OXFW970-based speakers driver
  *
@@ -806,15 +810,54 @@
 };
 MODULE_DEVICE_TABLE(ieee1394, fwspk_id_table);
 
+#if LINUX_VERSION_CODE < KERNEL_VERSION(3, 11, 0)
+static int __fwspk_probe(struct device *unit_dev)
+{
+	struct fw_unit *unit = fw_unit(unit_dev);
+	struct fw_device *fw_dev = fw_parent_device(unit);
+	struct fw_csr_iterator i;
+	int key, value;
+	const struct ieee1394_device_id *id = NULL;
+
+	fw_csr_iterator_init(&i, fw_dev->config_rom);
+	while (fw_csr_iterator_next(&i, &key, &value))
+		if (key == CSR_VENDOR)
+			switch (value) {
+			case VENDOR_GRIFFIN:
+				id = &fwspk_id_table[0];
+				goto out;
+			case VENDOR_LACIE:
+				id = &fwspk_id_table[1];
+				goto out;
+			}
+ out:
+	if (!id)
+		return -ENODEV;
+	return fwspk_probe(unit, id);
+}
+
+static int __fwspk_remove(struct device *dev)
+{
+	fwspk_remove(fw_unit(dev));
+	return 0;
+}
+#endif
+
 static struct fw_driver fwspk_driver = {
 	.driver   = {
 		.owner	= THIS_MODULE,
 		.name	= KBUILD_MODNAME,
 		.bus	= &fw_bus_type,
+#if LINUX_VERSION_CODE < KERNEL_VERSION(3, 11, 0)
+		.probe	= __fwspk_probe,
+		.remove	= __fwspk_remove,
+#endif
 	},
+#if LINUX_VERSION_CODE >= KERNEL_VERSION(3, 11, 0)
 	.probe    = fwspk_probe,
-	.update   = fwspk_bus_reset,
 	.remove   = fwspk_remove,
+#endif
+	.update   = fwspk_bus_reset,
 	.id_table = fwspk_id_table,
 };
 
